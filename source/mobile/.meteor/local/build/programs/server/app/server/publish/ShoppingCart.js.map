{"version":3,"sources":["meteor://ðŸ’»app/server/publish/ShoppingCart.js"],"names":[],"mappings":"eAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/server/publish/ShoppingCart.js","sourcesContent":["/**\n * Created on 9/18/15.\n */\n\n//just for test\nMeteor.publish(\"accountShoppingCart\", function () {\n    return DB.ShoppingCart.find({\n        accountId: this.userId\n    });\n});\n\nMeteor.publish(\"activeShoppingCart\", function () {\n    return DB.ShoppingCart.find({\n        status: 'active',\n        type:'register',\n        lastModified: {$gt: new Date(+new Date() - 15 * 60 * 1000)}, // 15åˆ†ä»¥å†…çš„ todo save time as config\n        accountId: this.userId\n    });\n});\n\n\nMeteor.publish(\"historyShoppingCart\", function () {\n    return DB.ShoppingCart.find({\n        status: 'done',\n        type:'register',\n        accountId: this.userId\n    });\n});\n\n//todo delete\nMeteor.publish(\"nowShoppingCart\", function () {\n    return DB.ShoppingCart.find({\n        type:'register',\n        status: {\n            $in: ['active', 'checking','applied']\n        },\n        accountId: this.userId\n    });\n});\n\n\nMeteor.publish(\"checkingShoppingCart\", function () {\n    return DB.ShoppingCart.find({\n\n        $and: [\n            {\n                type:'register',\n                status: 'checking',\n                accountId: this.userId\n            },\n            {\n\n                \"$or\": [\n                    {\n                        checkoutType: 'pay-now',\n                        lastModified: {$gt: new Date(+new Date() - 15 * 60 * 1000)}\n\n                    }, {\n                        checkoutType: 'pay-in-store',\n                        lastModified: {$gt: new Date(+new Date() - 24 * 60 * 60 * 1000)}\n\n                    }]\n            }\n        ]\n\n    });\n});\n\n\nMeteor.publish(\"allRegisterShoppingCart\", function () {\n    return DB.ShoppingCart.find({\n        type:'register',\n        //status: {\n        //    $in: ['checking']\n        //}\n    });\n});\n\n"]}