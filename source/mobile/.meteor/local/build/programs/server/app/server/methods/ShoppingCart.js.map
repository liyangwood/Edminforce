{"version":3,"sources":["meteor://üíªapp/server/methods/ShoppingCart.js"],"names":[],"mappings":"eAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/server/methods/ShoppingCart.js","sourcesContent":["/**\n * Created on 9/18/15.\n */\n\n//\"Not permitted. Untrusted code may only update documents by ID\"\n//So define special update methods\n//refer http://stackoverflow.com/questions/15464507/understanding-not-permitted-untrusted-code-may-only-update-documents-by-id-m\n\n\n\nMeteor.startup(function () {\n\n    Meteor.methods({\n\n        //active\n        add_class_to_cart: shoppingCart.add_class_to_cart,\n        add_preference_to_cart: shoppingCart.add_preference_to_cart,\n\n        delete_class_from_cart:shoppingCart.delete_class_from_cart,\n        change_preference_in_cart:shoppingCart.change_preference_in_cart,\n\n\n        //Ê∏ÖÈô§‰∏çÂÆåÊï¥Ë¥≠Áâ©È°π\n        clear_uncompleted_item_in_cart:shoppingCart.clear_uncompleted_item_in_cart,\n\n        //active => checking\n        move_to_checking: shoppingCart.move_to_checking,\n\n        //checking => applied\n        move_to_applied: shoppingCart.move_to_applied,\n\n        //applied=>done\n        move_to_done:shoppingCart.move_to_done,\n\n\n        //////can only called from server//////\n        //this.connection==null\n        cron_move_applied_to_done:shoppingCart.cron_move_applied_to_done,\n        cron_expiring:shoppingCart.cron_expiring,\n\n\n        ///cancel class\n        cancel_class:function(swimmerId,classId){\n            //check if has been cancel\n\n            var item = DB.ClassesRegister.findOne({\n                swimmerId:swimmerId,\n                classId:classId\n            })\n            if(!item){\n                throw new Meteor.Error(500, 'swimmerId don not have that class');\n\n            }else if(item.status=='canceling'){\n                throw new Meteor.Error(500, 'class is already canceling process');\n\n            }\n\n            shoppingCart.cancel_add_class_to_cart(swimmerId,classId)\n        },\n\n\n        ///change class\n\n        change_class:function(swimmerId, fromClassId, toClassId){\n\n            //todo check ÈÄªËæëÊèêÂá∫Êù•\n            shoppingCart.change_class(\n                swimmerId,\n                fromClassId,\n                toClassId\n            )\n        }\n\n\n    })\n\n\n})\n"]}