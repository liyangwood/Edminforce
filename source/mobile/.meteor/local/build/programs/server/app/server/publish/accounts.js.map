{"version":3,"sources":["meteor://üíªapp/server/publish/accounts.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/server/publish/accounts.js","sourcesContent":["!function () {\n\n\n    var extraFileds = {\n        'profile': 1,\n        //'role': 1,\n        //'credits': 1,\n        'alterContact': 1,\n        'emergencyContact': 1,\n        // 'optInCheck': 1Ôºå\n        //'swimmers': 1\n    };\n\n    //todo remove\n    Meteor.publish(\"accounts\", function () {\n        return Meteor.users.find();\n    });\n\n\n    //publish account detail\n    Meteor.publish(\"accountCurrent\", function () {\n        var accountId = this.userId\n        return Meteor.users.find({_id: accountId}, {fields: extraFileds});\n    });\n\n\n    /*\n     * publish  [account detail] and [swimmers detail] and  [classes detail]\n     *\n     * publishÂçï‰∏™account‰∏ãÁöÑÊâÄÊúâswimmer ‰ª•ÂèäÊØè‰∏™swimmerÊâÄÈÄâËØæÁ®ãÁöÑËØ¶ÁªÜ‰ø°ÊÅØ\n     *\n     * */\n    //Meteor.publishComposite('accountWithSwimmersAndClasses', function(accountId) {\n    //    return {\n    //        find: function() {\n    //            return Meteor.users.find({_id:accountId}, {fields: extraFileds});\n    //        },\n    //        children: [\n    //            {\n    //                find: function(account) {  //ÊâÄÊúâswimmers\n    //\n    //                    console.log(account)\n    //\n    //                    return DB.Swimmers.find(\n    //                        { accountId: account._id });\n    //                },\n    //                children: [\n    //                    {\n    //                        find: function(swimmers, account) {//swimmersÂØπÂ∫îÁöÑclass\n    //\n    //                            console.log(swimmers)\n    //                            return DB.Classes.find(\n    //                                {\n    //                                    _id: { $in:swimmers.classes }\n    //\n    //                                });\n    //                        },\n    //                        children:[  //for test\n    //                            {\n    //                                find:function(classes, swimmers, account){\n    //\n    //                                    console.log(classes)\n    //\n    //                                }\n    //                            }\n    //\n    //                        ]\n    //                    }\n    //                ]\n    //            }\n    //        ]\n    //    }\n    //});\n    //\n\n    Meteor.publishComposite('accountWithSwimmersAndClasses', function () {\n\n        var accountId = this.userId\n\n        return {\n            find: function () {\n                return Meteor.users.find({_id: accountId}, {fields: extraFileds});\n            },\n            children: [\n                {\n                    find: function (account) {  //ÊâÄÊúâswimmers\n\n                        //console.log(account)\n\n                        return DB.Swimmers.find(\n                            {accountId: account._id});\n                    },\n                    children: [\n                        {\n                            find: function (swimmer, account) {//swimmersÂØπÂ∫îÁöÑclass id\n\n                                //console.log(swimmer)\n                                return DB.ClassesRegister.find(\n                                    {\n                                        swimmerId: swimmer._id\n\n                                    });\n                            },\n                            children: [\n                                {\n                                    find: function (classesRegister, swimmer, account) {//classÂØπÂ∫îÁöÑËØ¶ÁªÜ‰ø°ÊÅØ\n\n                                        //console.log(classesRegister)\n\n                                        return DB.Classes.find(\n                                            {\n                                                _id: classesRegister.classId\n\n                                            });\n                                    },\n                                    children: [\n                                        {\n                                            find: function (classDetail, classesRegister, swimmer, account) {//just for test\n\n                                                //console.log(classDetail)\n\n                                            }\n                                        }\n                                    ]\n\n\n                                }\n                            ]\n                        }\n                    ]\n                }\n            ]\n        }\n    });\n\n\n\n\n\n    //////////////for Admin only//////////////////\n\n    Meteor.publish(\"adminAccountById\", function (accountId) {\n        //var accountId = this.userId\n        return Meteor.users.find({_id: accountId}, {fields: extraFileds});\n    });\n\n\n}();\n\n\n\n\n\n\n"]}