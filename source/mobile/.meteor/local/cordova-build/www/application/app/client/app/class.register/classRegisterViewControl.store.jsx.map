{"version":3,"sources":["meteor://üíªapp/client/app/class.register/classRegisterViewControl.store.jsx"],"names":[],"mappings":"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","file":"/client/app/class.register/classRegisterViewControl.store.jsx","sourcesContent":["/**\n * Created on 9/14/15.\n */\n\nDependency.add('ClassRegister.ViewControl.store',new function(){\n\n    var self = this;\n\n    //ÂÆö‰πâ‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê leftNavÊâìÂºÄÂÖ≥Èó≠\n    /*\n        0  ‰∏ã‰∏™sessionÁöÑÊ≥®ÂÜåÂ∞öÊú™ÂºÄÂßã Êú¨sessionÂ∑≤ÂÖ≥Èó≠\n        1  Á¨¨‰∏ÄÈò∂ÊÆµ\n        2  Á¨¨2Èò∂ÊÆµ\n        3  Á¨¨3Èò∂ÊÆµ\n        4  Á¨¨4Èò∂ÊÆµ\n        5  Â∑≤ÁªèËøá‰∫ÜÁ¨¨4‰∏™Èò∂ÊÆµ ‰ΩÜ‰ªçÂºÄÊîæÊ≥®ÂÜåÔºü\n\n        ÁõÆÂâç‰∏çÊòØserver side render ÁúüÊ≠£Â§Ñ‰∫éÈÇ£‰∏™Èò∂ÊÆµ ÂêéÁ´Ø‰ªçÈúÄcheck\n\n    * */\n    self.registerStage = new ReactiveVar(1)\n\n    self.appInfo = new ReactiveVar(1)\n\n\n\n    self.getCurrentClassCount= function(){\n        var appInfo= self.appInfo.get()\n\n        //if(!App.info) return;\n        return DB.ClassesRegister.find({\n            accountId:Meteor.userId(),\n            sessionId:appInfo && appInfo.sessionNow\n        })\n\n    }\n\n\n\n\n    self.getHistoryClassCount= function(){\n        //if(!App.info) return;\n        var appInfo= self.appInfo.get()\n\n        return DB.ClassesRegister.find({\n            accountId:Meteor.userId(),\n            sessionId:{$nin:[appInfo && appInfo.sessionNow , appInfo && appInfo.sessionRegister]}\n        })\n\n    }\n\n\n     //ÂΩìÂâçÊó∂Èó¥\n    function getStage(){\n        //meteor  call\n\n    }\n\n    //acount ÊòØÂê¶ÊúâswimmerÊ≠£Âú®ÂèÇ‰∏éËØæÁ®ã\n\n\n    self.tokenId = Dispatcher.register(function(payload){\n        switch(payload.actionType){\n\n\n            case \"CRRegistraionInfoPage_CONTINUE\":{\n\n                var registerStage = self.registerStage.get()\n                var isActive = self.getCurrentClassCount().count()\n                var hasHistory = self.getHistoryClassCount().count()\n\n\n\n                //var registerHref=\"/classRegister/register\"\n\n                var commonRegisterPage = \"/classRegister/SelectClass\"\n                var BookTheSameTimePage =\"/classRegister/BookTheSameTimePage\"\n\n                if(registerStage ==1){//\n\n                    if(isActive){\n\n                        FlowRouter.go(BookTheSameTimePage);\n\n                    }else{\n                        if(hasHistory){\n\n                            alert('Á¨¨‰∏âÈò∂ÊÆµÂÜçÊù•')\n\n                        }else{\n\n                            alert('Á¨¨ÂõõÈò∂ÊÆµÂÜçÊù•')\n                        }\n                    }\n\n                }else if(registerStage ==2){//currentÂèØËá™Áî±ÈÄâÊã©\n\n                    if(isActive){\n\n                        FlowRouter.go(commonRegisterPage);\n\n                    }else{\n                        if(hasHistory){\n\n                            alert('Á¨¨‰∏âÈò∂ÊÆµÂÜçÊù•')\n\n                        }else{\n\n                            alert('Á¨¨ÂõõÈò∂ÊÆµÂÜçÊù•')\n                        }\n                    }\n\n                }else if(registerStage ==3){//return userÂèØÈÄâÊã©\n                    if(isActive){\n\n                        FlowRouter.go(commonRegisterPage);\n\n                    }else{\n                        if(hasHistory){\n\n                            FlowRouter.go(commonRegisterPage);\n                           // alert('Á¨¨‰∏âÈò∂ÊÆµÂÜçÊù•')\n\n                        }else{\n\n                            alert('Á¨¨ÂõõÈò∂ÊÆµÂÜçÊù•')\n\n                        }\n                    }\n\n\n                }else if(registerStage ==4){//ÊâÄÊúâÁî®Êà∑ÂèØÈÄâÊã©\n\n                    FlowRouter.go(commonRegisterPage);\n\n                }\n\n                break;\n            }\n\n        }\n    });\n\n\n\n    Meteor.startup(function () {\n        Meteor.subscribe('registerInfoByAccountId',Meteor.userId())\n\n\n        Tracker.autorun(function () {\n            //if(!DB.Swimmers) return;\n\n            var appInfo = DB.App.findOne()\n\n            if(appInfo){\n                self.appInfo.set(appInfo)\n                self.registerStage.set(appInfo.registerStage)\n            }\n\n        })\n    })\n\n\n});"]}